{"version":3,"file":"loop.component.js","sourceRoot":"","sources":["../usr/local/google/home/tdresser/github/wooper/tmp/broccoli_type_script_compiler-input_base_path-XRKN3K9Y.tmp/0/src/app/loop.component.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,qBAAgG,eAAe,CAAC,CAAA;AAEhH,sCAA+C,yBAAyB,CAAC,CAAA;AACzE,qBAAgC,QAAQ,CAAC,CAAA;AAoDzC;IAsBI,uBAAY,UAAsB,EAAE,QAAkB;QAJ9C,oBAAe,GAAc,gBAAS,CAAC,KAAK,CAAC;QAE3C,eAAU,GAAG,IAAI,mBAAY,EAAE,CAAC;QAGtC,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzB,IAAI,CAAC,KAAK,GAAG,IAAI,WAAI,EAAE,CAAC;IAC5B,CAAC;IAxBD,sBAAW,0BAAS;aAApB,cAAiC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;;;OAAA;;IAC9C,sBAAW,6BAAY;aAAvB,cAAoC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC;;;OAAA;;IAChD,sBAAW,0BAAS;aAApB,cAAiC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC;;;OAAA;;IAC7C,sBAAW,gCAAe;aAA1B,cAAuC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;;;OAAA;;IACpD,sBAAW,8BAAa;aAAxB,cAAqC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC;;;OAAA;;IAsBjD,sBAAW,+BAAI;aAAf;YACI,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC;QACtB,CAAC;;;OAAA;IAEO,yCAAiB,GAAzB,UAA0B,SAAoB;QAC1C,MAAM,CAAA,CAAC,SAAS,CAAC,CAAC,CAAC;YACnB,KAAK,gBAAS,CAAC,KAAK;gBAChB,MAAM,CAAC,MAAM,CAAC;YAClB,KAAK,gBAAS,CAAC,SAAS;gBACpB,MAAM,CAAC,MAAM,CAAC;YAClB,KAAK,gBAAS,CAAC,OAAO;gBAClB,MAAM,CAAC,MAAM,CAAC;YAClB,KAAK,gBAAS,CAAC,OAAO;gBAClB,MAAM,CAAC,MAAM,CAAC;QAClB,CAAC;IACL,CAAC;IAED,kCAAU,GAAV;QACI,IAAI,KAAa,CAAC;QAClB,EAAE,CAAC,CAAC,IAAI,CAAC,eAAe,IAAI,gBAAS,CAAC,KAAK,CAAC,CAAC,CAAC;YAC1C,KAAK,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;QACzD,CAAC;QAAC,IAAI,CAAC,CAAC;YACJ,KAAK,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;QACzD,CAAC;QAED,MAAM,CAAC;YACH,KAAK,EAAE,aAAa,CAAC,SAAS,GAAG,IAAI;YACrC,MAAM,EAAE,aAAa,CAAC,SAAS,GAAG,IAAI;YACtC,SAAS,EAAE,CAAC,aAAa,CAAC,SAAS,GAAG,CAAC,GAAG,IAAI;YAC9C,UAAU,EAAE,CAAC,aAAa,CAAC,SAAS,GAAG,CAAC,GAAG,IAAI;YAC/C,eAAe,EAAE,KAAK;SACzB,CAAC;IACN,CAAC;IAED,sCAAc,GAAd;QACI,MAAM,CAAC;YACH,KAAK,EAAE,aAAa,CAAC,aAAa,GAAG,IAAI;YACzC,MAAM,EAAE,aAAa,CAAC,aAAa,GAAG,IAAI;YAC1C,SAAS,EAAE,CAAC,aAAa,CAAC,aAAa,GAAG,CAAC,GAAG,IAAI;YAClD,UAAU,EAAE,CAAC,aAAa,CAAC,aAAa,GAAG,CAAC,GAAG,IAAI;YACnD,OAAO,EAAE,IAAI,CAAC,eAAe,IAAI,gBAAS,CAAC,KAAK,GAAG,OAAO,GAAG,MAAM;SACtE,CAAC;IACN,CAAC;IAED,8CAAsB,GAAtB,UAAuB,CAAC;QACpB,IAAI,CAAC,GAAG,CAAC,CAAC,OAAO,GAAG,aAAa,CAAC,SAAS,GAAG,CAAC,CAAC;QAChD,IAAI,CAAC,GAAG,CAAC,CAAC,OAAO,GAAG,aAAa,CAAC,SAAS,GAAG,CAAC,CAAC;QAEhD,IAAI,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;QAExC,EAAE,CAAC,CAAC,QAAQ,GAAG,aAAa,CAAC,SAAS,CAAC,CAAC,CAAC;YACrC,IAAI,CAAC,mBAAmB,CAAC,SAAS,GAAG,iCAAS,CAAC,eAAe,CAAC;YAC/D,MAAM,CAAC;QACX,CAAC;QAED,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QAC7B,IAAI,sBAAsB,GAAG,KAAK,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC;QAC3D,EAAE,CAAC,CAAC,sBAAsB,GAAG,CAAC,CAAC,CAAC,CAAC;YAC7B,sBAAsB,IAAI,CAAC,CAAC;QAChC,CAAC;QACD,EAAE,CAAC,CAAC,sBAAsB,GAAG,IAAI,CAAC,CAAC,CAAC;YAChC,IAAI,CAAC,mBAAmB,CAAC,SAAS,GAAG,iCAAS,CAAC,IAAI,CAAC;QACxD,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,sBAAsB,GAAG,GAAG,CAAC,CAAC,CAAC;YACtC,IAAI,CAAC,mBAAmB,CAAC,SAAS,GAAG,iCAAS,CAAC,KAAK,CAAC;QACzD,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,sBAAsB,GAAG,IAAI,CAAC,CAAC,CAAC;YACvC,IAAI,CAAC,mBAAmB,CAAC,SAAS,GAAG,iCAAS,CAAC,EAAE,CAAC;QACtD,CAAC;QAAC,IAAI,CAAC,CAAC;YACJ,IAAI,CAAC,mBAAmB,CAAC,SAAS,GAAG,iCAAS,CAAC,IAAI,CAAC;QACxD,CAAC;QAED,EAAE,CAAC,CAAC,IAAI,CAAC,mBAAmB,CAAC,SAAS,KAAK,iCAAS,CAAC,IAAI,CAAC,CAAC,CAAC;YACxD,EAAE,CAAC,CAAC,QAAQ,GAAG,aAAa,CAAC,eAAe,CAAC,CAAC,CAAC;gBAC3C,IAAI,CAAC,mBAAmB,CAAC,SAAS,GAAG,iCAAS,CAAC,OAAO,CAAC;gBACvD,IAAI,CAAC,UAAU,GAAG,CAAC,CAAC,OAAO,CAAC;gBAC5B,IAAI,CAAC,UAAU,GAAG,CAAC,CAAC,OAAO,CAAC;gBAC5B,uDAAuD;gBACvD,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;gBAC3B,IAAI,CAAC,uBAAuB,EAAE,CAAC;gBAC/B,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;gBACzD,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,iBAAiB,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC;YACjE,CAAC;QACL,CAAC;IACL,CAAC;IAED,+CAAuB,GAAvB;QACI,uGAAuG;QACvG,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC;YACvB,MAAM,CAAC;QACX,CAAC;QACD,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;QAClE,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,KAAK,CAAC,GAAG,GAAG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;QACjE,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;IAC/B,CAAC;IAED,iCAAS,GAAT,UAAU,CAAC;QACP,IAAI,CAAC,UAAU,GAAG,CAAC,CAAC,OAAO,CAAC;QAC5B,IAAI,CAAC,UAAU,GAAG,CAAC,CAAC,OAAO,CAAC;QAC5B,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC;YACvB,IAAI,CAAC,cAAc,GAAG,MAAM,CAAC,qBAAqB,CAAC,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QAChG,CAAC;IACL,CAAC;IAED,4BAAI,GAAJ,UAAK,OAAe;QAChB,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IAC5B,CAAC;IAED,wCAAgB,GAAhB;QACI,MAAM,CAAA,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,CAAC;YAC9B,KAAK,gBAAS,CAAC,SAAS;gBACpB,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC;gBAC3B,KAAK,CAAC;YACV,KAAK,gBAAS,CAAC,OAAO;gBAClB,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,IAAI,gBAAS,CAAC,SAAS,CAAC,CAAC,CAAC;oBAC7C,4DAA4D;oBAC5D,8BAA8B;oBAC9B,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC;gBAC9B,CAAC;gBAAC,IAAI,CAAC,CAAC;oBACJ,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC;gBAC7B,CAAC;gBACD,KAAK,CAAC;YACV,KAAK,gBAAS,CAAC,OAAO;gBAClB,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;gBACxB,KAAK,CAAC;YACV;gBACI,OAAO,CAAC,MAAM,EAAE,CAAC;QACrB,CAAC;QACD,IAAI,CAAC,eAAe,GAAG,gBAAS,CAAC,KAAK,CAAC;IAC3C,CAAC;IAED,4CAA4C;IAC5C,iDAAyB,GAAzB,UAA0B,CAAC;QACvB,MAAM,CAAA,CAAC,IAAI,CAAC,mBAAmB,CAAC,SAAS,CAAC,CAAC,CAAC;YAC5C,KAAK,iCAAS,CAAC,eAAe;gBAC1B,MAAM,CAAA,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;oBAC7B,KAAK,gBAAS,CAAC,KAAK;wBAChB,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC;wBAC3B,KAAK,CAAC;oBACV,KAAK,gBAAS,CAAC,SAAS;wBACpB,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC;wBAC1B,KAAK,CAAC;oBACV,KAAK,gBAAS,CAAC,OAAO;wBAClB,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;wBACxB,KAAK,CAAC;oBACV,KAAK,gBAAS,CAAC,OAAO;wBAClB,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC;wBACzB,KAAK,CAAC;gBACV,CAAC;gBACD,KAAK,CAAC;YACV,KAAK,iCAAS,CAAC,EAAE;gBACb,qBAAqB;gBACrB,MAAM,CAAA,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;oBAC7B,KAAK,gBAAS,CAAC,KAAK;wBAChB,IAAI,CAAC,eAAe,GAAG,gBAAS,CAAC,SAAS,CAAC;wBAC3C,KAAK,CAAC;oBACV,KAAK,gBAAS,CAAC,SAAS;wBACpB,IAAI,CAAC,eAAe,GAAG,gBAAS,CAAC,OAAO,CAAC;wBACzC,KAAK,CAAC;oBACV,KAAK,gBAAS,CAAC,OAAO;wBAClB,IAAI,CAAC,eAAe,GAAG,gBAAS,CAAC,OAAO,CAAC;wBACzC,KAAK,CAAC;oBACV,KAAK,gBAAS,CAAC,OAAO;wBAClB,IAAI,CAAC,eAAe,GAAG,gBAAS,CAAC,OAAO,CAAC;wBACzC,KAAK,CAAC;gBACV,CAAC;gBAED,gEAAgE;gBAChE,mEAAmE;gBACnE,aAAa;gBACb,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,CAAC;gBAC1D,KAAK,CAAC;YACV,KAAK,iCAAS,CAAC,IAAI;gBACf,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC;gBAClB,IAAI,CAAC,eAAe,GAAG,gBAAS,CAAC,KAAK,CAAC;gBACvC,KAAK,CAAC;YACV,KAAK,iCAAS,CAAC,IAAI;gBACf,KAAK,CAAC;YACV,KAAK,iCAAS,CAAC,KAAK;gBAChB,KAAK,CAAC;YACV,KAAK,iCAAS,CAAC,OAAO;gBAClB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAC,CAAC,CAAC,OAAO,EAAE,CAAC,EAAC,CAAC,CAAC,OAAO,EAAC,CAAC,CAAC;gBAE7D,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC;gBAClB,uCAAuC;gBACvC,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC;gBACjD,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,KAAK,CAAC,GAAG,GAAI,KAAK,CAAC;gBACjD,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;gBAC5E,MAAM,CAAC,oBAAoB,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;gBACjD,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;gBAC3B,KAAK,CAAC;YACV;gBACI,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;QAC1B,CAAC;QAED,IAAI,CAAC,mBAAmB,CAAC,SAAS,GAAG,iCAAS,CAAC,WAAW,CAAC;IAC/D,CAAC;IAED,iCAAS,GAAT,UAAU,UAAU;QAChB,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;IACzC,CAAC;IAED,qCAAa,GAAb,UAAc,CAAQ,EAAE,CAAQ;QAC5B,IAAI,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,qBAAqB,EAAE,CAAC;QAEjE,IAAI,MAAM,GAAG,IAAI,CAAC,IAAI,GAAG,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,KAAK;YACxC,IAAI,CAAC,GAAG,GAAG,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC;QACpC,MAAM,CAAC,MAAM,CAAC;IAClB,CAAC;IAED,uCAAe,GAAf;QAAA,iBA+BC;QA9BG,IAAI,iBAAiB,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC;QAEtD,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,iBAAiB,EAAE,aAAa,EAAE,UAAC,CAAC;YACrD,oEAAoE;YAChF,iCAAiC;QACzB,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,iBAAiB,EAAE,aAAa,EAAE,UAAC,CAAC;YACrD,iBAAiB,CAAC,iBAAiB,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC;YACjD,KAAI,CAAC,mBAAmB,CAAC,SAAS,GAAG,iCAAS,CAAC,eAAe,CAAC;YAC/D,CAAC,CAAC,cAAc,EAAE,CAAC;QACvB,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,iBAAiB,EAAE,aAAa,EAAE,UAAC,CAAC;YACrD,CAAC,CAAC,cAAc,EAAE,CAAC;YACnB,EAAE,CAAC,CAAC,KAAI,CAAC,mBAAmB,CAAC,SAAS,KAAK,iCAAS,CAAC,WAAW,CAAC,CAAC,CAAC;gBAC/D,MAAM,CAAC;YACX,CAAC;YACD,EAAE,CAAC,CAAC,KAAI,CAAC,mBAAmB,CAAC,SAAS,KAAK,iCAAS,CAAC,OAAO,CAAC,CAAC,CAAC;gBAC3D,KAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;gBAClB,MAAM,CAAC;YACX,CAAC;YACD,KAAI,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC;QACnC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,iBAAiB,EAAE,WAAW,EAAE,UAAC,CAAC;YACnD,KAAI,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QACtC,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,iBAAiB,EAAE,eAAe,EAAE,UAAC,CAAC;YACvD,KAAI,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;QACtC,CAAC,CAAC,CAAC;IACP,CAAC;IAnQD;QAAC,gBAAS,CAAC,2CAAmB,CAAC;;8DAAA;IAG/B;QAAC,gBAAS,CAAC,YAAY,CAAC;;qDAAA;IACxB;QAAC,gBAAS,CAAC,eAAe,CAAC;;wDAAA;IAS3B;QAAC,aAAM,EAAE;;qDAAA;IAtEb;QAAC,gBAAS,CAAC;YACP,QAAQ,EAAE,MAAM,CAAC,EAAE;YACnB,QAAQ,EAAE,MAAM;YAChB,QAAQ,EAAE,g5BA2Cb;YACG,MAAM,EAAE,EAAE;YACV,UAAU,EAAE,CAAC,2CAAmB,CAAC;SACpC,CAAC;;qBAAA;IA4QF,oBAAC;AAAD,CAAC,AA3QD,IA2QC;AA3QY,qBAAa,gBA2QzB,CAAA","sourcesContent":["import { Component, ViewChild, ElementRef, Renderer, AfterViewInit, Output, EventEmitter } from '@angular/core';\n\nimport { RadialMenuComponent, DragState } from './radial-menu.component';\nimport { Loop, PlayState } from './loop';\n\n@Component({\n    moduleId: module.id,\n    selector: 'loop',\n    template: `\n    <style>\n      :host {\n        width:150px;\n        height:150px;\n      }\n\n      #loop-button {\n        border-radius: 50%;\n        z-index:1;\n        position:absolute;\n        left:50%;\n        top:50%;\n      }\n\n      #loop-container {\n        width:100%;\n        height:100%;\n        position:relative;\n      }\n\n      radial-menu {\n        width:100%;\n        height:100%;\n        display:block;\n      }\n\n      #queueing {\n        background-color:black;\n        border-radius: 50%;\n        z-index:2;\n        position:absolute;\n        left:50%;\n        top:50%;\n      }\n\n    </style>\n    <div #loopContainer id='loop-container'>\n      <radial-menu [playState]=\"_loop.playState\"></radial-menu>\n      <div #loopButton id='loop-button' [ngStyle]='loopStyles()'>\n        <div #queueing id='queueing' [ngStyle]='queueingStyles()'></div>\n      </div>\n    </div>\n`,\n    styles: [],\n    directives: [RadialMenuComponent]\n})\nexport class LoopComponent implements AfterViewInit {\n    static get LOOP_SIZE(): number { return 100; };\n    static get LOOP_PADDING(): number { return 25; };\n    static get SLOP_SIZE(): number { return 75; };\n    static get MERGE_SLOP_SIZE(): number { return 120; };\n    static get QUEUEING_SIZE(): number { return 20; };\n\n    @ViewChild(RadialMenuComponent)\n    radialMenuComponent: RadialMenuComponent;\n\n    @ViewChild('loopButton') loopButton;\n    @ViewChild('loopContainer') loopContainer;\n\n    private _loop: Loop;\n    private renderer: Renderer;\n    private mergeDragX: number;\n    private mergeDragY: number;\n    private animationFrame;\n    private queuedPlayState: PlayState = PlayState.Empty;\n\n    @Output() mergeEvent = new EventEmitter();\n\n    constructor(elementRef: ElementRef, renderer: Renderer) {\n        this.renderer = renderer;\n        this._loop = new Loop();\n    }\n\n    public get loop() {\n        return this._loop;\n    }\n\n    private colorForPlayState(playState: PlayState) {\n        switch(playState) {\n        case PlayState.Empty:\n            return '#888';\n        case PlayState.Recording:\n            return '#f00';\n        case PlayState.Playing:\n            return '#0f0';\n        case PlayState.Stopped:\n            return '#0a0';\n        }\n    }\n\n    loopStyles() {\n        let color: string;\n        if (this.queuedPlayState != PlayState.Empty) {\n            color = this.colorForPlayState(this.queuedPlayState);\n        } else {\n            color = this.colorForPlayState(this._loop.playState);\n        }\n\n        return {\n            width: LoopComponent.LOOP_SIZE + 'px',\n            height: LoopComponent.LOOP_SIZE + 'px',\n            marginTop: -LoopComponent.LOOP_SIZE / 2 + 'px',\n            marginLeft: -LoopComponent.LOOP_SIZE / 2 + 'px',\n            backgroundColor: color\n        };\n    }\n\n    queueingStyles() {\n        return {\n            width: LoopComponent.QUEUEING_SIZE + 'px',\n            height: LoopComponent.QUEUEING_SIZE + 'px',\n            marginTop: -LoopComponent.QUEUEING_SIZE / 2 + 'px',\n            marginLeft: -LoopComponent.QUEUEING_SIZE / 2 + 'px',\n            display: this.queuedPlayState != PlayState.Empty ? 'block' : 'none'\n        };\n    }\n\n    updateRadialMenuOnMove(e):void {\n        let x = e.offsetX - LoopComponent.LOOP_SIZE / 2;\n        let y = e.offsetY - LoopComponent.LOOP_SIZE / 2;\n\n        let distance = Math.sqrt(x * x + y * y);\n\n        if (distance < LoopComponent.SLOP_SIZE) {\n            this.radialMenuComponent.dragState = DragState.DragNoDirection;\n            return;\n        }\n\n        let angle = Math.atan2(x, y);\n        let angleMappedToQuadrants = angle / (2 * Math.PI) + 0.125;\n        if (angleMappedToQuadrants < 0) {\n            angleMappedToQuadrants += 1;\n        }\n        if (angleMappedToQuadrants < 0.25) {\n            this.radialMenuComponent.dragState = DragState.Down;\n        } else if (angleMappedToQuadrants < 0.5) {\n            this.radialMenuComponent.dragState = DragState.Right;\n        } else if (angleMappedToQuadrants < 0.75) {\n            this.radialMenuComponent.dragState = DragState.Up;\n        } else {\n            this.radialMenuComponent.dragState = DragState.Left;\n        }\n\n        if (this.radialMenuComponent.dragState === DragState.Left) {\n            if (distance > LoopComponent.MERGE_SLOP_SIZE) {\n                this.radialMenuComponent.dragState = DragState.Merging;\n                this.mergeDragX = e.clientX;\n                this.mergeDragY = e.clientY;\n                // TODO - this is a hack - see updateMergeDragPosition.\n                this.animationFrame = true;\n                this.updateMergeDragPosition();\n                document.body.appendChild(this.loopButton.nativeElement);\n                this.loopButton.nativeElement.setPointerCapture(e.pointerId);\n            }\n        }\n    }\n\n    updateMergeDragPosition() {\n        // TODO - this check shouldn't be needed, but for some reason cancelAnimationFrame isn't doing its job.\n        if (!this.animationFrame) {\n            return;\n        }\n        this.loopButton.nativeElement.style.left = this.mergeDragX + 'px';\n        this.loopButton.nativeElement.style.top = this.mergeDragY + 'px';\n        this.animationFrame = null;\n    }\n\n    dragMerge(e): void {\n        this.mergeDragX = e.clientX;\n        this.mergeDragY = e.clientY;\n        if (!this.animationFrame) {\n            this.animationFrame = window.requestAnimationFrame(this.updateMergeDragPosition.bind(this));\n        }\n    }\n\n    load(content: string): void {\n        this.loop.load(content);\n    }\n\n    applyQueuedState(): void {\n        switch(this.queuedPlayState) {\n        case PlayState.Recording:\n            this.loop.startRecording();\n            break;\n        case PlayState.Playing:\n            if (this.loop.playState == PlayState.Recording) {\n                // TODO - we shouldn't depend on the fact that stopRecording\n                // starts playing in this way.\n                this.loop.stopRecording();\n            } else {\n                this.loop.startPlaying();\n            }\n            break;\n        case PlayState.Stopped:\n            this.loop.stopPlaying();\n            break;\n        default:\n            console.assert();\n        }\n        this.queuedPlayState = PlayState.Empty;\n    }\n\n    // TODO - distinguish between cancel and up.\n    updateRadialMenuOnRelease(e): void {\n        switch(this.radialMenuComponent.dragState) {\n        case DragState.DragNoDirection:\n            switch(this.loop.playState) {\n            case PlayState.Empty:\n                this.loop.startRecording();\n                break;\n            case PlayState.Recording:\n                this.loop.stopRecording();\n                break;\n            case PlayState.Playing:\n                this.loop.stopPlaying();\n                break;\n            case PlayState.Stopped:\n                this.loop.startPlaying();\n                break;\n            }\n            break;\n        case DragState.Up:\n            // Queue next action.\n            switch(this.loop.playState) {\n            case PlayState.Empty:\n                this.queuedPlayState = PlayState.Recording;\n                break;\n            case PlayState.Recording:\n                this.queuedPlayState = PlayState.Playing;\n                break;\n            case PlayState.Playing:\n                this.queuedPlayState = PlayState.Stopped;\n                break;\n            case PlayState.Stopped:\n                this.queuedPlayState = PlayState.Playing;\n                break;\n            }\n\n            // TODO - tie this in to the audio time. This can break since we\n            // never clear the timeout, but it isn't worth fixing, because it's\n            // temporary.\n            window.setTimeout(this.applyQueuedState.bind(this), 1000);\n            break;\n        case DragState.Down:\n            this.loop.clear();\n            this.queuedPlayState = PlayState.Empty;\n            break;\n        case DragState.Left:\n            break;\n        case DragState.Right:\n            break;\n        case DragState.Merging:\n            this.mergeEvent.emit({loop: this, x:e.clientX, y:e.clientY});\n\n            this.loop.clear();\n            // TODO - this is duplicated right now.\n            this.loopButton.nativeElement.style.left = '50%';\n            this.loopButton.nativeElement.style.top =  '50%';\n            this.loopContainer.nativeElement.appendChild(this.loopButton.nativeElement);\n            window.cancelAnimationFrame(this.animationFrame);\n            this.animationFrame = null;\n            break;\n        default:\n            console.assert(false);\n        }\n\n        this.radialMenuComponent.dragState = DragState.NotDragging;\n    }\n\n    mergeWith(sourceLoop): void {\n        this.loop.mergeWith(sourceLoop.loop);\n    }\n\n    containsPoint(x:number, y:number): boolean {\n        let rect = this.loopButton.nativeElement.getBoundingClientRect();\n\n        let result = rect.left < x && x < rect.right &&\n            rect.top < y && y < rect.bottom;\n        return result;\n    }\n\n    ngAfterViewInit(): void {\n        let loopButtonElement = this.loopButton.nativeElement;\n\n        this.renderer.listen(loopButtonElement, 'contextmenu', (e) => {\n            // TODO - right click is useful for debugging, but can break things.\n//            e.preventDefault();\n        });\n\n        this.renderer.listen(loopButtonElement, 'pointerdown', (e) => {\n            loopButtonElement.setPointerCapture(e.pointerId);\n            this.radialMenuComponent.dragState = DragState.DragNoDirection;\n            e.preventDefault();\n        });\n        this.renderer.listen(loopButtonElement, 'pointermove', (e) => {\n            e.preventDefault();\n            if (this.radialMenuComponent.dragState === DragState.NotDragging) {\n                return;\n            }\n            if (this.radialMenuComponent.dragState === DragState.Merging) {\n                this.dragMerge(e);\n                return;\n            }\n            this.updateRadialMenuOnMove(e);\n        });\n\n        this.renderer.listen(loopButtonElement, 'pointerup', (e) => {\n            this.updateRadialMenuOnRelease(e);\n        });\n        this.renderer.listen(loopButtonElement, 'pointercancel', (e) => {\n            this.updateRadialMenuOnRelease(e);\n        });\n    }\n}\n"]}