{"version":3,"file":"loop.component.js","sourceRoot":"","sources":["../usr/local/google/home/tdresser/github/wooper/tmp/broccoli_type_script_compiler-input_base_path-jze09wkM.tmp/0/src/app/loop.component.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,qBAA2D,eAAe,CAAC,CAAA;AAE3E,sCAAoC,yBAAyB,CAAC,CAAA;AAC9D,qBAAqB,QAAQ,CAAC,CAAA;AAE9B,WAAY,SAAS;IACjB,uDAAW,CAAA;IACX,+DAAe,CAAA;IACf,qCAAE,CAAA;IACF,yCAAI,CAAA;IACJ,yCAAI,CAAA;IACJ,2CAAK,CAAA;AACT,CAAC,EAPW,iBAAS,KAAT,iBAAS,QAOpB;AAPD,IAAY,SAAS,GAAT,iBAOX,CAAA;AA2CD;IAUI,uBAAY,UAAsB,EAAE,QAAkB;QAoEtD,4EAA4E;QAC5E,yDAAyD;QACjD,cAAS,GAAc,SAAS,CAAC,WAAW,CAAC;QAErD,6DAA6D;QACrD,kBAAa,GAAG,SAAS,CAAC;QAxE9B,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzB,IAAI,CAAC,IAAI,GAAG,IAAI,WAAI,EAAE,CAAC;IAC3B,CAAC;IAZD,sBAAW,0BAAS;aAApB,cAAgC,MAAM,CAAC,GAAG,CAAA,CAAC,CAAC;;;OAAA;;IAC5C,sBAAW,6BAAY;aAAvB,cAAmC,MAAM,CAAC,EAAE,CAAA,CAAC,CAAC;;;OAAA;;IAC9C,sBAAW,0BAAS;aAApB,cAAgC,MAAM,CAAC,EAAE,CAAA,CAAC,CAAC;;;OAAA;;IAY3C,kCAAU,GAAV;QACI,MAAM,CAAC;YACH,KAAK,EAAE,aAAa,CAAC,SAAS,GAAG,IAAI;YACrC,MAAM,EAAE,aAAa,CAAC,SAAS,GAAG,IAAI;YACtC,SAAS,EAAE,CAAC,aAAa,CAAC,SAAS,GAAC,CAAC,GAAG,IAAI;YAC5C,UAAU,EAAE,CAAC,aAAa,CAAC,SAAS,GAAC,CAAC,GAAG,IAAI;SAChD,CAAA;IACL,CAAC;IAED,wCAAgB,GAAhB;QACI,MAAM,CAAC;YACH,SAAS,EAAE,CAAC,2CAAmB,CAAC,IAAI,GAAC,CAAC,GAAG,IAAI;YAC7C,UAAU,EAAE,CAAC,2CAAmB,CAAC,IAAI,GAAC,CAAC,GAAG,IAAI;SACjD,CAAA;IACL,CAAC;IAGD,uCAAe,GAAf;QAAA,iBA0CC;QAzCG,IAAI,iBAAiB,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC;QACtD,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,iBAAiB,EAAE,aAAa,EAAE,UAAC,CAAC;YACrD,iBAAiB,CAAC,iBAAiB,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC;YACjD,KAAI,CAAC,SAAS,GAAG,SAAS,CAAC,eAAe,CAAC;YAC3C,CAAC,CAAC,cAAc,EAAE,CAAC;QACvB,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,iBAAiB,EAAE,aAAa,EAAE,UAAC,CAAC;YACrD,EAAE,CAAC,CAAC,KAAI,CAAC,SAAS,IAAI,SAAS,CAAC,WAAW,CAAC;gBACxC,MAAM,CAAC;YACX,CAAC,CAAC,cAAc,EAAE,CAAC;YACnB,IAAI,CAAC,GAAG,CAAC,CAAC,OAAO,GAAG,aAAa,CAAC,SAAS,GAAG,CAAC,CAAC;YAChD,IAAI,CAAC,GAAG,CAAC,CAAC,OAAO,GAAG,aAAa,CAAC,SAAS,GAAG,CAAC,CAAC;YAEhD,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,aAAa,CAAC,SAAS,GAAG,aAAa,CAAC,SAAS,CAAC,CAAC,CAAC;gBACpE,KAAI,CAAC,SAAS,GAAG,SAAS,CAAC,eAAe,CAAC;gBAC3C,KAAI,CAAC,mBAAmB,CAAC,SAAS,GAAG,KAAI,CAAC,SAAS,CAAC;gBACpD,MAAM,CAAC;YACX,CAAC;YAED,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YAC7B,IAAI,sBAAsB,GAAG,KAAK,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC;YAC3D,EAAE,CAAC,CAAC,sBAAsB,GAAG,CAAC,CAAC;gBAC3B,sBAAsB,IAAI,CAAC,CAAC;YAChC,EAAE,CAAC,CAAC,sBAAsB,GAAG,IAAI,CAAC;gBAC9B,KAAI,CAAC,SAAS,GAAG,SAAS,CAAC,IAAI,CAAC;YACpC,IAAI,CAAC,EAAE,CAAC,CAAC,sBAAsB,GAAG,GAAG,CAAC;gBAClC,KAAI,CAAC,SAAS,GAAG,SAAS,CAAC,KAAK,CAAC;YACrC,IAAI,CAAC,EAAE,CAAC,CAAC,sBAAsB,GAAG,IAAI,CAAC;gBACnC,KAAI,CAAC,SAAS,GAAG,SAAS,CAAC,EAAE,CAAC;YAClC,IAAI;gBACA,KAAI,CAAC,SAAS,GAAG,SAAS,CAAC,IAAI,CAAC;YAEpC,KAAI,CAAC,mBAAmB,CAAC,SAAS,GAAG,KAAI,CAAC,SAAS,CAAC;QACxD,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,iBAAiB,EAAE,WAAW,EAAE,UAAC,CAAC;YACnD,KAAI,CAAC,SAAS,GAAG,SAAS,CAAC,WAAW,CAAC;QAC3C,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,iBAAiB,EAAE,eAAe,EAAE,UAAC,CAAC;YACvD,KAAI,CAAC,SAAS,GAAG,SAAS,CAAC,WAAW,CAAC;QAC3C,CAAC,CAAC,CAAC;IACP,CAAC;IArED;QAAC,gBAAS,CAAC,2CAAmB,CAAC;;8DAAA;IAG/B;QAAC,gBAAS,CAAC,YAAY,CAAC;;qDAAA;IAjD5B;QAAC,gBAAS,CAAC;YACP,QAAQ,EAAE,MAAM,CAAC,EAAE;YACnB,QAAQ,EAAE,MAAM;YAChB,QAAQ,EAAE,0wBAkCb;YACG,MAAM,EAAE,EAAE;YACV,UAAU,EAAE,CAAC,2CAAmB,CAAC;SACpC,CAAC;;qBAAA;IAqFF,oBAAC;AAAD,CAAC,AApFD,IAoFC;AApFY,qBAAa,gBAoFzB,CAAA","sourcesContent":["import { Component, ViewChild, ElementRef, Renderer } from '@angular/core';\n\nimport { RadialMenuComponent } from './radial-menu.component';\nimport { Loop } from './loop';\n\nexport enum DragState {\n    NotDragging,\n    DragNoDirection,\n    Up,\n    Down,\n    Left,\n    Right\n}\n\n@Component({\n    moduleId: module.id,\n    selector: 'loop',\n    template: `\n    <style>\n      :host {\n        width:150px;\n        height:150px;\n      }\n\n      #loop-button {\n        border-radius: 50%;\n        background-color: #888;\n        z-index:1;\n        position:absolute;\n        left:50%;\n        top:50%;\n      }\n\n      #loop-container {\n        width:100%;\n        height:100%;\n        position:relative;\n      }\n\n      radial-menu {\n        position:absolute;\n        left:50%;\n        top:50%;\n        display:none;\n      }\n\n    </style>\n    <div id=\"loop-container\">\n      <radial-menu [style.display] = \"dragState == dragStateType.NotDragging ? 'none': 'block'\" [ngStyle]=\"radialMenuStyles()\"></radial-menu>\n      <div #loopButton id=\"loop-button\" [ngStyle]=\"loopStyles()\"></div>\n    </div>\n`,\n    styles: [],\n    directives: [RadialMenuComponent]\n})\nexport class LoopComponent {\n    static get LOOP_SIZE():number { return 100 };\n    static get LOOP_PADDING():number { return 25 };\n    static get SLOP_SIZE():number { return 75 };\n\n    @ViewChild(RadialMenuComponent)\n    radialMenuComponent: RadialMenuComponent;\n\n    @ViewChild(\"loopButton\") loopButton;\n\n    constructor(elementRef: ElementRef, renderer: Renderer) {\n        this.renderer = renderer;\n        this.loop = new Loop();\n    }\n\n    loopStyles() {\n        return {\n            width: LoopComponent.LOOP_SIZE + \"px\",\n            height: LoopComponent.LOOP_SIZE + \"px\",\n            marginTop: -LoopComponent.LOOP_SIZE/2 + \"px\",\n            marginLeft: -LoopComponent.LOOP_SIZE/2 + \"px\"\n        }\n    }\n\n    radialMenuStyles() {\n        return {\n            marginTop: -RadialMenuComponent.SIZE/2 + \"px\",\n            marginLeft: -RadialMenuComponent.SIZE/2 + \"px\",\n        }\n    }\n\n\n    ngAfterViewInit(): void {\n        var loopButtonElement = this.loopButton.nativeElement;\n        this.renderer.listen(loopButtonElement, \"pointerdown\", (e) => {\n            loopButtonElement.setPointerCapture(e.pointerId);\n            this.dragState = DragState.DragNoDirection;\n            e.preventDefault();\n        });\n        this.renderer.listen(loopButtonElement, \"pointermove\", (e) => {\n            if (this.dragState == DragState.NotDragging)\n                return;\n            e.preventDefault();\n            let x = e.offsetX - LoopComponent.LOOP_SIZE / 2;\n            let y = e.offsetY - LoopComponent.LOOP_SIZE / 2;\n\n            if (x * x + y * y < LoopComponent.SLOP_SIZE * LoopComponent.SLOP_SIZE) {\n                this.dragState = DragState.DragNoDirection;\n                this.radialMenuComponent.dragState = this.dragState;\n                return;\n            }\n\n            var angle = Math.atan2(x, y);\n            var angleMappedToQuadrants = angle / (2 * Math.PI) + 0.125;\n            if (angleMappedToQuadrants < 0)\n                angleMappedToQuadrants += 1;\n            if (angleMappedToQuadrants < 0.25)\n                this.dragState = DragState.Down;\n            else if (angleMappedToQuadrants < 0.5)\n                this.dragState = DragState.Right;\n            else if (angleMappedToQuadrants < 0.75)\n                this.dragState = DragState.Up;\n            else\n                this.dragState = DragState.Left;\n\n            this.radialMenuComponent.dragState = this.dragState;\n        });\n\n        this.renderer.listen(loopButtonElement, \"pointerup\", (e) => {\n            this.dragState = DragState.NotDragging;\n        });\n        this.renderer.listen(loopButtonElement, \"pointercancel\", (e) => {\n            this.dragState = DragState.NotDragging;\n        });\n    }\n\n    private loop: Loop;\n    private renderer: Renderer;\n    // TODO(tdresser): Should probably use fancy data binding for this variable,\n    // between the LoopComponent and the RadialMenuComponent.\n    private dragState: DragState = DragState.NotDragging;\n\n    // This is a hack, to enable accessing an enum in a template.\n    private dragStateType = DragState;\n}\n"]}